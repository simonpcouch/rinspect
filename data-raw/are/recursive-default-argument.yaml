title: recursive-default-argument
input: "I see:\n\n```\nError:\n! promise already under evaluation: recursive default
  argument reference or earlier problems?\n```\n\nWhen evaluating the function returned
  by this function:\n\n```\ngenerate <- function(chat = ellmer::chat_claude()) {\n
  \ \n  function(input, chat = chat) {\n    ch <- chat$clone()\n    res <- ch$chat(input)\n
  \   list(result = res, chat = ch)\n  }\n}\n```\n\nHow can I fix it?"
target: It can be fixed by changing the name of the `chat` argument in one of the
  functions or assigning the `chat` object in the outer function to a different variable
  name internally and then supplying that renamed object as the default to the inner
  function.
domain: Programming
task: Debugging
knowledge: base R
source: https://github.com/simonpcouch/rinspect
