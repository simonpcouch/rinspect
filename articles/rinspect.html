<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with rinspect • rinspect</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with rinspect">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rinspect</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/rinspect.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/simonpcouch/rinspect/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with rinspect</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/simonpcouch/rinspect/blob/main/vignettes/rinspect.Rmd" class="external-link"><code>vignettes/rinspect.Rmd</code></a></small>
      <div class="d-none name"><code>rinspect.Rmd</code></div>
    </div>

    
    
<p>At their core, LLM evals are composed of three pieces:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Datasets</strong> contain a set of labelled samples.
Datasets are just a tibble with columns <code>input</code> and
<code>target</code>, where <code>input</code> is a prompt and
<code>target</code> is either literal value(s) or grading guidance.</li>
<li>
<strong>Solvers</strong> evaluate the <code>input</code> in the
dataset and produce a final result (hopefully) approximating
<code>target</code>. In rinspect, the simplest solver is just an ellmer
chat (e.g. <code><a href="https://ellmer.tidyverse.org/reference/chat_claude.html" class="external-link">ellmer::chat_claude()</a></code>).</li>
<li>
<strong>Scorers</strong> evaluate the final output of solvers. They
may use text comparisons, model grading, or other custom schemes to
determine how well the solver approximated the <code>target</code> based
on the <code>input</code>.</li>
</ol>
<p>This vignette will explore these three steps one-by-one using
<code>are</code>, an example dataset that ships with the package.</p>
<p>First, load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/simonpcouch/rinspect" class="external-link">rinspect</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ellmer.tidyverse.org" class="external-link">ellmer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="an-r-eval-dataset">An R eval dataset<a class="anchor" aria-label="anchor" href="#an-r-eval-dataset"></a>
</h2>
<p>From the <code>are</code> docs:</p>
<blockquote>
<p>An R Eval is a dataset of challenging R coding problems. Each
<code>input</code> is a question about R code which could be solved on
first-read only by human experts and, with a chance to read
documentation and run some code, by fluent data scientists. Solutions
are in <code>target</code> and enable a fluent data scientist to
evaluate whether the solution deserves full, partial, or no credit.</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">are</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Rows: 29</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ title     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "after-stat-bar-heights", "conditional-grouped-summary", "co…</span></span>
<span><span class="co">#&gt; $ input     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "This bar chart shows the count of different cuts of diamond…</span></span>
<span><span class="co">#&gt; $ target    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Preferably: \n\n```\nggplot(data = diamonds) + \n  geom_bar…</span></span>
<span><span class="co">#&gt; $ domain    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Data analysis", "Data analysis", "Data analysis", "Programm…</span></span>
<span><span class="co">#&gt; $ task      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "New code", "New code", "New code", "Debugging", "New code",…</span></span>
<span><span class="co">#&gt; $ source    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "https://jrnold.github.io/r4ds-exercise-solutions/data-visua…</span></span>
<span><span class="co">#&gt; $ knowledge <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> "tidyverse", "tidyverse", "tidyverse", "r-lib", "tidyverse"…</span></span></code></pre>
<p>At a high level:</p>
<ul>
<li>
<code>title</code>: A unique identifier for the problem.</li>
<li>
<code>input</code>: The question to be answered.</li>
<li>
<code>target</code>: The solution, often with a description of
notable features of a correct solution.</li>
<li>
<code>domain</code>, <code>task</code>, and <code>knowledge</code>
are pieces of metadata describing the kind of R coding challenge.</li>
<li>
<code>source</code>: Where the problem came from, as a URL. Many of
these coding problems are adapted “from the wild” and include the kinds
of context usually available to those answering questions.</li>
</ul>
<p>For the purposes of actually carrying out the initial evaluation,
we’re specifically interested in the <code>input</code> and
<code>target</code> columns. Let’s print out the first entry in full so
you can get a taste of a typical problem in this dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">are</span><span class="op">$</span><span class="va">input</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; This bar chart shows the count of different cuts of diamonds, and each</span></span>
<span><span class="co">#&gt; bar is stacked and filled according to clarity:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; ggplot(data = diamonds) +</span></span>
<span><span class="co">#&gt; geom_bar(mapping = aes(x = cut, fill = clarity))</span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Could you change this code so that the proportion of diamonds with a</span></span>
<span><span class="co">#&gt; given cut corresponds to the bar height and not the count? Each bar</span></span>
<span><span class="co">#&gt; should still be filled according to clarity.</span></span></code></pre>
<p>Here’s the suggested solution:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">are</span><span class="op">$</span><span class="va">target</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Preferably:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; ggplot(data = diamonds) +</span></span>
<span><span class="co">#&gt; geom_bar(aes(x = cut, y = after_stat(count) / sum(after_stat(count)),</span></span>
<span><span class="co">#&gt; fill = clarity))</span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0, but</span></span>
<span><span class="co">#&gt; it still works:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; ggplot(data = diamonds) +</span></span>
<span><span class="co">#&gt; geom_bar(aes(x = cut, y = ..count.. / sum(..count..), fill = clarity))</span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simply setting `position = "fill" will result in each bar having a</span></span>
<span><span class="co">#&gt; height of 1 and is not correct.</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="creating-an-evaluation-task">Creating an evaluation task<a class="anchor" aria-label="anchor" href="#creating-an-evaluation-task"></a>
</h2>
<p><code><a href="../reference/task_create.html">task_create()</a></code> situates a dataset inside of an evaluation
<code>task</code>, a subclass of a tibble with some additional
attributes to track the experiment. Any dataset is fair game as long as
it has columns <code>input</code> and <code>target</code>. The
<code>name</code> argument is optional, but we’ll specify it here:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">are_task</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_create.html">task_create</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">are</span>, name <span class="op">=</span> <span class="st">"An R Eval"</span><span class="op">)</span></span>
<span><span class="va">are_task</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #555555;"># Evaluation task</span> <span style="color: #00BB00;">An R Eval</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 29 × 8</span></span></span>
<span><span class="co">#&gt;    title                       input  target domain task  source knowledge    id</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> after-stat-bar-heights      <span style="color: #949494;">"</span>This… <span style="color: #949494;">"</span>Pref… Data … New … https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> conditional-grouped-summary <span style="color: #949494;">"</span>I ha… <span style="color: #949494;">"</span>One … Data … New … https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> correlated-delays-reasoning <span style="color: #949494;">"</span>Here… <span style="color: #949494;">"</span>Nota… Data … New … NA     <span style="color: #949494;">&lt;chr [1]&gt;</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> curl-http-get               <span style="color: #949494;">"</span>I ha… <span style="color: #949494;">"</span>Ther… Progr… Debu… https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dropped-level-legend        <span style="color: #949494;">"</span>I'd … <span style="color: #949494;">"</span>Also… Data … New … https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> geocode-req-perform         <span style="color: #949494;">"</span>I am… <span style="color: #949494;">"</span>Form… Data … Debu… https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ggplot-breaks-feature       <span style="color: #949494;">"</span>Here… <span style="color: #949494;">"</span>```\… Progr… New … https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ggplot-breaks-feature       <span style="color: #949494;">"</span>Here… <span style="color: #949494;">"</span>```\… Progr… New … https… <span style="color: #949494;">&lt;chr [1]&gt;</span>     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> grouped-filter-summarize    <span style="color: #949494;">"</span>Here… <span style="color: #949494;">"</span>Ther… Data … New … NA     <span style="color: #949494;">&lt;chr [1]&gt;</span>     9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> grouped-mutate              <span style="color: #949494;">"</span>I ge… <span style="color: #949494;">"</span>From… Data … Debu… https… <span style="color: #949494;">&lt;chr [1]&gt;</span>    10</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 19 more rows</span></span></span></code></pre>
<p>The only notable change here for a user is the new <code>id</code>
column, which is just the row number.</p>
</div>
<div class="section level2">
<h2 id="solving-the-task-with-claude">Solving the task with Claude<a class="anchor" aria-label="anchor" href="#solving-the-task-with-claude"></a>
</h2>
<p>Next, we’ll use <code><a href="../reference/task_solve.html">task_solve()</a></code> to apply a solver to our
task. A solver is some function that takes in an <code>input</code>
question and produces a result. The most basic solver in rinspect is a
plain ellmer chat, like <code><a href="https://ellmer.tidyverse.org/reference/chat_claude.html" class="external-link">chat_claude()</a></code>. (ellmer chats
themselves are indeed not functions; rinspect special-cases them.) Users
can supply any function they please, though, that likely wraps calls to
ellmer chats in some way.</p>
<!--
TODO: link to a vignette on more involved solvers here
-->
<p>For this example, though, we’ll just use <code><a href="https://ellmer.tidyverse.org/reference/chat_claude.html" class="external-link">chat_claude()</a></code>.
At the time of writing, the current default model used by
<code><a href="https://ellmer.tidyverse.org/reference/chat_claude.html" class="external-link">chat_claude()</a></code> is claude-3-5-sonnet-latest.</p>
<!--
TODO: several epochs?
-->
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">are_solved</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_solve.html">task_solve</a></span><span class="op">(</span><span class="va">are_task</span>, solver <span class="op">=</span> <span class="fu"><a href="https://ellmer.tidyverse.org/reference/chat_claude.html" class="external-link">chat_claude</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Each <code>input</code> from the dataset is sent to Claude. For each
input prompt, Claude generates a response that attempts to solve the R
coding problem.</p>
<!--
TODO: discuss the time to evaluate here. with no parallelism and a single epoch, 30 rows took 3 minutes.
-->
<p><code><a href="../reference/task_solve.html">task_solve()</a></code> will append two columns,
<code>output</code> and <code>solver</code>. Here’s what the model
responded to that first question with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">are_solved</span><span class="op">$</span><span class="va">output</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Yes! To show proportions instead of counts, you can add `position =</span></span>
<span><span class="co">#&gt; "fill"` to the `geom_bar()` function. This will normalize each bar to</span></span>
<span><span class="co">#&gt; show the relative proportions of clarity within each cut category.</span></span>
<span><span class="co">#&gt; Here's the modified code:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; ggplot(data = diamonds) +</span></span>
<span><span class="co">#&gt; geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")</span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This will create a stacked bar chart where each bar has the same height</span></span>
<span><span class="co">#&gt; (1.0 or 100%), and the segments within each bar show the proportion of</span></span>
<span><span class="co">#&gt; diamonds with each clarity grade for that particular cut.</span></span></code></pre>
<p><code>output</code> is the final response from the solver, and the
<code>solver</code> is the ellmer chat object that led to the output.
It’s not technically required that your solvers provide these chats in
their output, but it <em>is</em> required if you’d like to explore your
evaluation results with <code><a href="../reference/inspect_view.html">inspect_view()</a></code>, which is highly
recommended.</p>
</div>
<div class="section level2">
<h2 id="scoring-the-solutions">Scoring the solutions<a class="anchor" aria-label="anchor" href="#scoring-the-solutions"></a>
</h2>
<p>Now we’ll evaluate the quality of Claude’s solutions using
<code><a href="../reference/task_score.html">task_score()</a></code> with the <code><a href="../reference/scorer_model.html">model_graded_qa()</a></code>
scorer:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">are_scored</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/task_score.html">task_score</a></span><span class="op">(</span></span>
<span>  <span class="va">are_solved</span>, </span>
<span>  scorer <span class="op">=</span> <span class="fu"><a href="../reference/scorer_model.html">model_graded_qa</a></span><span class="op">(</span>partial_credit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/scorer_model.html">model_graded_qa()</a></code> is a model-graded scorer provides by
the package. This step will compare Claude’s solutions against the
reference solutions provided in the <code>target</code> column,
assigning a score to each solution using another model. That score is
either <code>1</code> or <code>0</code>, though since we’ve set
<code>partial_credit = TRUE</code>, the model can also choose to allot
the response <code>.5</code>. rinspect will use the same model that
generate the final response in <code><a href="../reference/task_solve.html">task_solve()</a></code> as the model to
score solutions.</p>
<p>Hold up, though—we’re using an LLM to generate responses to
questions, and then using the LLM to grade those responses?</p>
<p><img src="https://cdn-useast1.kapwing.com/static/templates/3-spiderman-pointing-meme-template-full-ca8f27e0.webp" alt="The meme of 3 spiderman pointing at each other."></p>
<p>This technique is called “model grading” or “LLM-as-a-judge.” Done
correctly, model grading is an effective and scalable solution to
scoring. That said, it’s not without its faults. Here’s what the grading
model thought of the response:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">are_scored</span><span class="op">$</span><span class="va">scorer</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">last_turn</span><span class="op">(</span><span class="op">)</span><span class="op">@</span><span class="va">text</span><span class="op">)</span></span>
<span><span class="co">#&gt; Let me analyze this:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The criterion specifies that we want to show the overall proportion of</span></span>
<span><span class="co">#&gt; diamonds for each cut (i.e., how many diamonds of each cut there are</span></span>
<span><span class="co">#&gt; relative to the total number of diamonds), while still maintaining the</span></span>
<span><span class="co">#&gt; clarity breakdown within each cut.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The submitted answer suggests using `position = "fill"`, which actually</span></span>
<span><span class="co">#&gt; does something different - it normalizes each bar to a height of 1 (or</span></span>
<span><span class="co">#&gt; 100%) and shows the relative proportions of clarity within each cut.</span></span>
<span><span class="co">#&gt; This means each bar will have the same height regardless of how common</span></span>
<span><span class="co">#&gt; that cut is in the dataset.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This is incorrect because:</span></span>
<span><span class="co">#&gt; 1. It doesn't show the true proportion of each cut in the dataset</span></span>
<span><span class="co">#&gt; 2. Using `position = "fill"` standardizes each bar to height 1, which</span></span>
<span><span class="co">#&gt; masks the actual proportional differences between cuts</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The correct solution (as shown in the criterion) should use</span></span>
<span><span class="co">#&gt; `after_stat(count) / sum(after_stat(count))` to calculate the true</span></span>
<span><span class="co">#&gt; proportion of each cut relative to the total number of diamonds.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The submission provides a solution that creates a different</span></span>
<span><span class="co">#&gt; visualization than what was asked for, showing within-cut proportions</span></span>
<span><span class="co">#&gt; rather than overall proportions.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GRADE: I</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyzing-the-results">Analyzing the results<a class="anchor" aria-label="anchor" href="#analyzing-the-results"></a>
</h2>
<p>Especially the first few times you run an eval, you’ll want to
inspect (ha!) its outputs closely. The rinspect package ships with an
app, the Inspect log viewer, that allows you to drill down into the
solutions and grading decisions from each model for each sample. In the
first couple runs, you’ll likely find revisions you can make to your
grading guidance in <code>target</code> that align model responses with
your intent.</p>
<p>Interactively, we’d launch that app with
<code>inspect_view(are_scored)</code>. You can do so yourself (using
this eval specifically!) with the following code (TODO: code to grab
from github and view).</p>
<p>For a cursory analysis, we can visualize correct vs. partially
correct vs. incorrect answers:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">are_scored</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">are_scored</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>grade <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Correct"</span>,</span>
<span>    <span class="va">score</span> <span class="op">==</span> <span class="fl">.5</span> <span class="op">~</span> <span class="st">"Partially Correct"</span>,</span>
<span>    <span class="va">score</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Incorrect"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">grade</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Correct"</span>, <span class="st">"Partially Correct"</span>, <span class="st">"Incorrect"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">are_scored</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grade</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="rinspect_files/figure-html/plot-1-1.png" alt="A ggplot2 bar plot, showing Claude was correct most of the time." width="700"></p>
<p>Claude answered fully correctly in 14 out of 29 samples, and
partially correctly 8 times. For me, this leads to all sorts of
questions:</p>
<ul>
<li>Are there any models that are cheaper than Claude that would do just
as well? Or even a local model?</li>
<li>Are there other models available that would do better out of the
box?</li>
<li>Would Claude do better if I allow it to “reason” briefly before
answering?</li>
<li>Would Claude do better if I gave it tools that’d allow it to peruse
documentation and/or run R code before answering? (See <a href="https://simonpcouch.github.io/btw/reference/register_btw_tools.html" class="external-link"><code>btw::register_btw_tools()</code></a>
if you’re interested in this.)</li>
</ul>
<p>If you’re interested in these questions as well, check out the other
vignettes in this package!</p>
</div>
<div class="section level2">
<h2 id="saving-and-loading-evaluation-results">Saving and loading evaluation results<a class="anchor" aria-label="anchor" href="#saving-and-loading-evaluation-results"></a>
</h2>
<p>When storing evaluation results for later use, you have a couple
options:</p>
<ul>
<li>
<strong>Complete</strong>: <code>task</code>s are just tibbles, and
can be saved to <code>.rda</code> or <code>.rds</code> files using the
usual <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code> or <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code>. Tasks saved this
way can be reloaded back into R and passed to
<code><a href="../reference/inspect_view.html">inspect_view()</a></code>.</li>
<li>
<strong>Portable</strong>: Under the hood, when you
<code><a href="../reference/inspect_view.html">inspect_view()</a></code> a task, it’s written to a temporary
<code>.json</code> file that the Inspect log viewer can read. You can
write to a permanent (and more portable than <code>.rda</code>)
viewer-compatible <code>.json</code> file with
<code><a href="../reference/inspect_log.html">inspect_log()</a></code>. Tasks can’t be read back into R from the
<code>.json</code> directly, but you can still view them in the log
viewer with <code><a href="../reference/inspect_view.html">inspect_view()</a></code>.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Couch, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
